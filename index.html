<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audiotele - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ê—Ç—ç–µ–ª—å–∫–æ–π</title>
    <link rel="icon" type="image/x-icon" href="icon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="icon.ico">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104057165', 'ym');

        ym(104057165, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/104057165" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</head>
<body>
    <div id="app">
        <!-- Login Page -->
        <div id="loginPage" class="page active">
            <div class="login-container">
                <div class="login-form">
                    <h1>–ê—Ç—ç–µ–ª—å–∫–∞</h1>
                    <h2>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ê—Ç—ç–µ–ª—å–∫–æ–π</h2>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">–õ–æ–≥–∏–Ω:</label>
                            <input type="text" id="username" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
                    </form>
                    <div id="loginError" class="error-message" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page">
            <header class="header">
                <div class="header-content">
                    <h1>–ê—Ç—ç–µ–ª—å–∫–∞</h1>
                    <div class="user-info">
                        <span id="currentUser"></span>
                        <span id="currentRole"></span>
                        <button id="logoutBtn" class="btn btn-secondary">–í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </header>

            <main class="main-content">
                <div class="dashboard-container">
                    <!-- User Dashboard -->
                    <div id="userDashboard" class="dashboard-section">
                        <h2>–ú–æ—è –ê—Ç—ç–µ–ª—å–∫–∞</h2>
                        <div class="points-display">
                            <span class="points-value" id="userPoints">1</span>
                            <span class="points-label">–ê—Ç—ç–µ–ª—å–∫–∞</span>
                        </div>
                        
                        <!-- User Action Buttons -->
                        <div class="user-actions-buttons">
                            <button id="refreshPointsBtn" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                        
                        <!-- Shop Section for Users -->
                        <div id="shopSection" class="shop-section">
                            <h3>üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</h3>
                            <div class="shop-grid">
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üß¢ –†–µ–∫–ª–∞–º–Ω–∞—è –∫–µ–ø–∫–∞</h4>
                                        <p class="shop-item-price">27 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω–∞—è –∫–µ–ø–∫–∞', 27)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üè≠ –†–µ–∫–ª–∞–º–Ω–∞—è –ø–∞–Ω–∞–º–∞</h4>
                                        <p class="shop-item-price">46 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω–∞—è –ø–∞–Ω–∞–º–∞', 46)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üõçÔ∏è –†–µ–∫–ª–∞–º–Ω–∞—è —Å—É–º–∫–∞</h4>
                                        <p class="shop-item-price">38 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω–∞—è —Å—É–º–∫–∞', 38)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>‚úèÔ∏è –†–µ–∫–ª–∞–º–Ω–∞—è —Ä—É—á–∫–∞</h4>
                                        <p class="shop-item-price">3 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω–∞—è —Ä—É—á–∫–∞', 3)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üç∫ –†–µ–∫–ª–∞–º–Ω—ã–π —Ç–µ—Ä–º–æ—Å</h4>
                                        <p class="shop-item-price">65 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω—ã–π —Ç–µ—Ä–º–æ—Å', 65)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üîë –†–µ–∫–ª–∞–º–Ω—ã–π –±—Ä–µ–ª–æ–∫</h4>
                                        <p class="shop-item-price">8 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω—ã–π –±—Ä–µ–ª–æ–∫', 8)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üìù –†–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫–Ω–æ—Ç</h4>
                                        <p class="shop-item-price">14 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫–Ω–æ—Ç', 14)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                                
                                <div class="shop-item">
                                    <div class="shop-item-info">
                                        <h4>üè∑Ô∏è –†–µ–∫–ª–∞–º–Ω—ã–π –±–µ–π–¥–∂</h4>
                                        <p class="shop-item-price">15 –ê—Ç—ç–µ–ª—å–∫–∞</p>
                                    </div>
                                    <button class="btn btn-shop" onclick="pointsSystem.buyItem('–†–µ–∫–ª–∞–º–Ω—ã–π –±–µ–π–¥–∂', 15)">–ö—É–ø–∏—Ç—å</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Admin Dashboard -->
                    <div id="adminDashboard" class="dashboard-section" style="display: none;">
                        <div class="admin-header">
                            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ê—Ç—ç–µ–ª—å–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                            <div class="admin-actions-buttons">
                                <button id="adminRefreshBtn" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                            </div>
                        </div>
                        
                        <!-- Orders Section -->
                        <div class="orders-section">
                            <h3>üîî –ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</h3>
                            <div id="ordersList" class="orders-list">
                                <!-- Orders will be populated here -->
                            </div>
                        </div>
                        
                        <div class="admin-controls">
                            <div class="points-management">
                                <h3>–ò–∑–º–µ–Ω–∏—Ç—å –ê—Ç—ç–µ–ª—å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                                <div class="form-group">
                                    <label for="targetUser">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                                    <select id="targetUser" class="form-control">
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pointsAction">–î–µ–π—Å—Ç–≤–∏–µ:</label>
                                    <select id="pointsAction" class="form-control">
                                        <option value="add">–î–æ–±–∞–≤–∏—Ç—å –ê—Ç—ç–µ–ª—å–∫—É</option>
                                        <option value="remove">–£–±—Ä–∞—Ç—å –ê—Ç—ç–µ–ª—å–∫—É</option>
                                        <option value="set">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ê—Ç—ç–µ–ª—å–∫—É</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pointsAmount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ê—Ç—ç–µ–ª—å–∫–∏:</label>
                                    <input type="number" id="pointsAmount" class="form-control" min="1" value="1">
                                </div>
                                <button id="updatePointsBtn" class="btn btn-primary">–û–±–Ω–æ–≤–∏—Ç—å –ê—Ç—ç–µ–ª—å–∫—É</button>
                            </div>

                            <div class="users-list">
                                <h3>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                                <div class="users-controls">
                                    <input type="text" id="userSearchInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û –∏–ª–∏ –ª–æ–≥–∏–Ω—É...">
                                    <div class="supervisor-controls">
                                        <button id="supervisorCreateUserBtn" class="btn btn-primary">üë§ –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                                        <button id="supervisorExportReportBtn" class="btn btn-success">üìä –û—Ç—á–µ—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</button>
                                        <button id="supervisorExportOrdersReportBtn" class="btn btn-success">üìã –û—Ç—á–µ—Ç –ø–æ –∑–∞–∫–∞–∑–∞–º</button>
                                    </div>
                                    <div class="pagination-controls">
                                        <button id="prevPageBtn" class="btn btn-secondary">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>
                                        <span id="pageInfo">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                                        <button id="nextPageBtn" class="btn btn-secondary">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</button>
                                    </div>
                                </div>
                                <div id="usersList" class="users-grid"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Super Admin Dashboard -->
                    <div id="superAdminDashboard" class="dashboard-section" style="display: none;">
                        <div class="admin-header">
                            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏</h2>
                            <div class="admin-actions-buttons">
                                <button id="superAdminRefreshBtn" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                            </div>
                        </div>
                        
                        <div class="super-admin-controls">
                            <div class="admin-management">
                                <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                                <div class="form-group">
                                    <label for="newUserFio">–§–ò–û:</label>
                                    <input type="text" id="newUserFio" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–æ—Ä–æ–ø –ì–ª–µ–±">
                                </div>
                                <div class="form-group">
                                    <label for="newUsername">–õ–æ–≥–∏–Ω:</label>
                                    <input type="text" id="newUsername" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="newPassword">–ü–∞—Ä–æ–ª—å:</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="newPassword" class="form-control" style="flex: 1;">
                                        <button type="button" class="btn btn-secondary" onclick="pointsSystem.generatePassword('newPassword')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="newUserRole">–†–æ–ª—å:</label>
                                    <select id="newUserRole" class="form-control">
                                        <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                                        <option value="supervisor">–°—É–ø–µ—Ä–≤–∏–∑–æ—Ä</option>
                                        <option value="superadmin">–°—É–ø–µ—Ä –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="newUserPoints">–ù–∞—á–∞–ª—å–Ω–∞—è –ê—Ç—ç–µ–ª—å–∫–∞:</label>
                                    <input type="number" id="newUserPoints" class="form-control" min="1" value="1">
                                </div>
                                <div class="form-actions">
                                    <button id="createUserBtn" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                                </div>

                            </div>
                            </div>

                            <div class="admins-list">
                                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                                <div class="users-controls">
                                    <input type="text" id="adminSearchInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û –∏–ª–∏ –ª–æ–≥–∏–Ω—É...">
                                    <button id="exportReportBtn" class="btn btn-success">üìä –í—ã–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</button>
                                    <button id="exportOrdersReportBtn" class="btn btn-success">üìã –í—ã–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –∑–∞–∫–∞–∑–∞–º</button>
                                </div>
                                <div id="adminsList" class="users-grid"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        
        <!-- Edit User Modal -->
        <div id="editUserModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editUserFio">–§–ò–û:</label>
                        <input type="text" id="editUserFio" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="editUsername">–õ–æ–≥–∏–Ω:</label>
                        <input type="text" id="editUsername" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="editPassword">–ü–∞—Ä–æ–ª—å:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="editPassword" class="form-control" style="flex: 1;">
                            <button type="button" class="btn btn-secondary" onclick="pointsSystem.generatePassword('editPassword')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editUserRole">–†–æ–ª—å:</label>
                        <select id="editUserRole" class="form-control">
                            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                            <option value="supervisor">–°—É–ø–µ—Ä–≤–∏–∑–æ—Ä</option>
                            <option value="superadmin">–°—É–ø–µ—Ä –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editUserPoints">–ê—Ç—ç–µ–ª—å–∫–∞:</label>
                        <input type="number" id="editUserPoints" class="form-control" min="1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="saveUserChangesBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button id="cancelEditBtn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
        
        <!-- Modern Notification Modal -->
        <div id="notificationModal" class="modal" style="display: none;">
            <div class="modal-content notification-modal">
                <div class="modal-header notification-header">
                    <span id="notificationIcon">‚úì</span>
                    <h3 id="notificationTitle">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h3>
                    <span class="close notification-close" onclick="pointsSystem.closeNotification()">&times;</span>
                </div>
                <div class="modal-body notification-body">
                    <p id="notificationMessage">–°–æ–æ–±—â–µ–Ω–∏–µ</p>
                </div>
                <div class="modal-footer notification-footer">
                    <button class="btn btn-primary" onclick="pointsSystem.closeNotification()">–û–ö</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            ‚ù§Ô∏è –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –¥–ª—è Audiotele | 
            <a href="https://t.me/Edward_Kallin" target="_blank" rel="noopener noreferrer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</a> | 
            <a href="https://forms.yandex.ru/u/68bcba7ff47e73d9e027d1bd" target="_blank" rel="noopener noreferrer">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</a>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
